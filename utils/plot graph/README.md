This code was adapted from 
https://gist.github.com/tarlen5/008809c3decf19313de216b9208f3734
